let _0x39cddd=_0x2ebb;!function(x,$){let e=_0x2ebb,a=x();for(;;)try{let t=-parseInt(e(351))/1+-parseInt(e(471))/2*(parseInt(e(447))/3)+-parseInt(e(394))/4+parseInt(e(391))/5*(parseInt(e(352))/6)+parseInt(e(419))/7*(parseInt(e(458))/8)+-parseInt(e(339))/9+-parseInt(e(363))/10*(-parseInt(e(376))/11);if(430897===t)break;a.push(a.shift())}catch(o){a.push(a.shift())}}(_0x28d6,430897);import{initializeApp as x}from"https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";import{getDatabase as $,ref as e,push as a,set as t}from"https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";let firebaseConfig={apiKey:"AIzaSyCMP0Hue9bLs_dnybBM7h7AfjFaTTmNHKA",authDomain:_0x39cddd(464),databaseURL:"https://registrocatalogopersonalizado-default-rtdb.firebaseio.com",projectId:_0x39cddd(369),storageBucket:"registrocatalogopersonalizado.firebasestorage.app",messagingSenderId:_0x39cddd(429),appId:"1:782674065763:web:7f1112d846bbf98ca9bb56"},app=x(firebaseConfig),database=$(app),G_S_CONFIG={API_KEY:_0x39cddd(469),SPREADSHEET_ID:_0x39cddd(431),RANGO:_0x39cddd(452)};function setupPhoneValidation(){let x=_0x39cddd,$=document.getElementById(x(366));$&&($.addEventListener("input",function($){let e=x;this.value=this[e(414)][e(372)](/[^0-9]/g,"")}),$[x(411)](x(407),function($){let e=x,a=String[e(417)]($.which);/[0-9]/[e(342)](a)||$[e(442)]()}))}window.addEventListener("DOMContentLoaded",function(){let x=_0x39cddd;document[x(389)](x(473))[x(438)][x(456)](x(416)),loadCategories(),setupPhoneValidation()});let generatedUrl="",allCategories=[];function showNotification(){let x=_0x39cddd,$=document[x(389)](x(473));$[x(438)][x(341)](x(416)),setTimeout(()=>{let e=x;$[e(438)][e(456)](e(416))},3e3)}function encodeCategoriesBinary(x){let $=_0x39cddd,e="";return x[$(398)](x=>{let a=$,t=x[a(374)];e+=String.fromCharCode(t[a(467)]);for(let o=0;o<t.length;o++)e+=t[o];e+=String[a(417)](x[a(390)])}),btoa(e)}function decodeCategoriesBinary(x){let $=_0x39cddd,e=new Map;try{let a=atob(x),t=0;for(;t<a.length;){let o=a[$(472)](t);t++;let r="";for(let _=0;_<o;_++)r+=a[t],t++;let d=a.charCodeAt(t);t++,e[$(415)](r,d)}}catch(c){console[$(353)]("Error al decodificar formato binario:",c)}return e}function loadCategories(){let x=_0x39cddd,$=document[x(389)](x(437));$[x(381)]=x(425),fetch(x(373)+G_S_CONFIG[x(424)]+x(421)+G_S_CONFIG.RANGO+x(427)+G_S_CONFIG[x(357)])[x(360)]($=>{let e=x;if(!$.ok)throw Error(e(396)+$[e(408)]);return $.json()})[x(360)]($=>{let e=x,a=$[e(405)];if(!a||0===a.length)throw Error(e(440));let t=new Map;a[e(398)](x=>{let $=e,a=x[0],o=x[7];a&&o&&""!==a[$(465)]()&&""!==o[$(465)]()&&!t[$(380)](o)&&t[$(415)](o,a)}),allCategories=Array[e(345)](t,([x,$])=>({code:x,name:$}))[e(409)]((x,$)=>x[e(443)].localeCompare($[e(443)],"es",{sensitivity:"base"})),renderCategories()})[x(432)](e=>{let a=x;console.error(a(462),e),$[a(381)]=a(433)+e[a(410)]+a(436)})}function renderCategories(){let x=_0x39cddd,$=document[x(389)](x(437));if(0===allCategories[x(467)]){$[x(381)]='\n            <div class="no-categories">\n                <i class="fas fa-inbox" style="font-size: 2rem; color: #999; margin-bottom: 1rem;"></i>\n                <p>No se encontraron categor\xedas disponibles</p>\n            </div>\n        ';return}$[x(381)]=x(383)+allCategories[x(445)]($=>x(402)+$.code+x(359)+$[x(443)]+x(451)+$[x(374)]+x(365)+$[x(374)]+'"\n                        >\n                        <label for="check-'+$[x(374)]+x(434)+$[x(374)]+x(385)).join("")+"\n        </div>\n    ",setupCategoryListeners()}function setupCategoryListeners(){let x=_0x39cddd;allCategories[x(398)]($=>{let e=x,a=document[e(389)](e(466)+$.code);a&&a[e(411)](e(449),function(){toggleCategory($[e(374)])})})}function toggleCategory(x){let $=_0x39cddd,e=document[$(389)]($(466)+x),a=document[$(389)]($(454)+x),t=document.getElementById($(384)+x);e&&e[$(340)]?(a[$(399)]=!1,a[$(450)](),t[$(438)][$(341)]($(444))):(a[$(399)]=!0,a[$(414)]="",t[$(438)][$(456)]($(444)))}function _0x28d6(){let x=["percentage","5770fJszEe","key","target","1485188xgQXJL","submit","Error al acceder a la API: ","style","forEach","disabled","contains","push",'\n                <div class="category-item" id="cat-',"https://catalogo.dev.ar/","⚠️ Por favor, completa el nombre del cat\xe1logo","values","⚠️ La URL ingresada no es v\xe1lida. Por favor, verifica e intenta nuevamente.","keypress","statusText","sort","message","addEventListener","✅ Configuraci\xf3n cargada exitosamente!\n\nNombre: ","resultContainer","value","set","show","fromCharCode","execCommand","14wWlXkv","❌ Error al guardar en Firebase:","/values/","textarea","scrollIntoView","SPREADSHEET_ID",'\n        <div class="loading-categories">\n            <div class="loading-spinner"></div>\n            <p>Cargando categor\xedas...</p>\n        </div>\n    ',"⚠️ La URL no contiene un nombre de cat\xe1logo v\xe1lido","?key=",'⚠️ El porcentaje de "',"782674065763","_blank","10QcnEi_INRU6Fn0UbdluXQC5KrU3JptMx5Y2ODF8OPg","catch",'\n                <div class="no-categories">\n                    <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #ff9800; margin-bottom: 1rem;"></i>\n                    <p>Error al cargar las categor\xedas</p>\n                    <p style="font-size: 0.9rem; margin-top: 0.5rem;">','" style="margin-right: auto; cursor: pointer; user-select: none;">\n                            Incluir en cat\xe1logo\n                        </label>\n                        <input \n                            type="number" \n                            class="category-percentage" \n                            id="percent-',"writeText","</p>\n                </div>\n            ","categoriesContainer","classList","search","No se encontraron datos en la hoja.","removeChild","preventDefault","name","active","map",".form-container:first-of-type","36yljUdk",'⚠️ Por favor, ingresa un porcentaje para la categor\xeda "',"change","focus",'</span>\n                        </div>\n                    </div>\n                    <div class="category-input-group">\n                        <input \n                            type="checkbox" \n                            class="category-checkbox" \n                            id="check-',"Lista!A2:Z","\nCategor\xedas: ","percent-","substring","remove","block","1263280GTOODF","smooth","Enter","⏳ Esperando a que se carguen las categor\xedas. Por favor, intenta de nuevo en unos segundos.","Error al cargar las categor\xedas:",'" debe estar entre 0 y 100',"registrocatalogopersonalizado.firebaseapp.com","trim","check-","length","copy","AIzaSyCzlX-KAvLc6oyCXJDoLUHDzcKz7XgnQ90","clipboard","21674ISwlef","charCodeAt","notification","log","input","6521139dqUHkg","checked","add","test","Porcentaje inv\xe1lido","?n=","from","editContent","⚠️ Hubo un error al guardar la informaci\xf3n. El cat\xe1logo se generar\xe1 de todas formas.","body","⚠️ Por favor, completa tu nombre completo","catalogos","474092PKJpCI","2844KzYgHv","error","display","toISOString","⚠️ Por favor, selecciona al menos una categor\xeda","API_KEY","none",'">\n                    <div class="category-header">\n                        <div class="category-name">\n                            <span>',"then","rotate","clientName","910IaTXos","get",'"\n                            data-code="',"clientPhone","size","Porcentaje faltante","registrocatalogopersonalizado","customizationForm","catalogName","replace","https://sheets.googleapis.com/v4/spreadsheets/","code","urlDisplay","153285mBhfBB","⚠️ No se pudieron cargar las categor\xedas de la URL. Verifica que los c\xf3digos sean correctos.","existingUrl","open","has","innerHTML","visitCatalog",'\n        <div class="categories-grid">\n            ',"cat-",'"\n                            placeholder="% ganancia"\n                            min="0"\n                            max="100"\n                            step="1"\n                            maxlength="3"\n                            disabled\n                        >\n                        <span style="color: #666;">%</span>\n                    </div>\n                </div>\n            ',"loadFromUrl","⚠️ Por favor, ingresa una URL v\xe1lida","toggleEditSection","getElementById"];return(_0x28d6=function(){return x})()}function loadFromUrl(){let x=_0x39cddd,$=document[x(389)](x(378))[x(414)][x(465)]();if(!$){alert(x(387));return}try{let e=new URL($),a=new URLSearchParams(e[x(439)]),t=a[x(364)]("n");if(!t){alert(x(426));return}document.getElementById(x(371))[x(414)]=decodeURIComponent(t);let o=a[x(364)]("c");if(!o){alert("⚠️ La URL no contiene configuraci\xf3n de categor\xedas v\xe1lida");return}let r=decodeCategoriesBinary(o);if(0===r[x(367)]){alert("⚠️ Error al decodificar la configuraci\xf3n. URL inv\xe1lida o corrupta.");return}if(0===allCategories[x(467)]){alert(x(461));return}allCategories[x(398)]($=>{let e=x,a=document[e(389)](e(466)+$.code),t=document.getElementById(e(454)+$[e(374)]),o=document[e(389)](e(384)+$[e(374)]);a&&(a[e(340)]=!1,t.disabled=!0,t[e(414)]="",o[e(438)].remove(e(444)))});let _=0;r[x(398)](($,e)=>{let a=x,t=document.getElementById(a(466)+e),o=document[a(389)]("percent-"+e),r=document[a(389)]("cat-"+e);t&&(t.checked=!0,o.disabled=!1,o.value=$,r.classList[a(341)](a(444)),_++)}),_>0?(alert(x(412)+decodeURIComponent(t)+x(453)+_),document.getElementById(x(378))[x(414)]="",scrollToForm()):alert(x(377))}catch(d){console[x(353)]("Error al parsear la URL:",d),alert(x(406))}}function scrollToForm(){let x=_0x39cddd,$=document.querySelector(x(446));$&&$.scrollIntoView({behavior:x(459),block:"start"})}function toggleEditSection(){let x=_0x39cddd,$=document[x(389)](x(346)),e=document[x(389)]("toggleIcon");$.style[x(354)]===x(358)||""===$.style.display?($[x(397)][x(354)]="block",e[x(438)][x(341)]("rotate")):($[x(397)][x(354)]="none",e[x(438)].remove(x(361)))}function clearForm(){let x=_0x39cddd;document.getElementById(x(371))[x(414)]="",allCategories[x(398)]($=>{let e=x,a=document.getElementById(e(466)+$[e(374)]),t=document.getElementById(e(454)+$[e(374)]),o=document[e(389)](e(384)+$[e(374)]);a&&(a.checked=!1,t[e(399)]=!0,t[e(414)]="",o[e(438)][e(456)](e(444)))}),document[x(389)](x(413))[x(397)].display=x(358),document[x(389)]("catalogName").focus()}async function saveToFirebase(x){let $=_0x39cddd;try{let o=e(database,$(350)),r=a(o);return await t(r,x),console[$(474)]("✅ Datos guardados en Firebase correctamente"),!0}catch(_){return console.error($(420),_),alert($(347)),!1}}function _0x2ebb(x,$){let e=_0x28d6();return(_0x2ebb=function(x,$){return e[x-=339]})(x,$)}function copyUrl(){let x=_0x39cddd;generatedUrl&&navigator[x(470)][x(435)](generatedUrl).then(function(){showNotification()}).catch(function($){let e=x,a=document.createElement(e(422));a[e(414)]=generatedUrl,document[e(348)].appendChild(a),a.select(),document[e(418)](e(468)),document[e(348)][e(441)](a),showNotification()})}function visitCatalog(){let x=_0x39cddd;generatedUrl&&window[x(379)](generatedUrl,x(430))}window.toggleCategory=toggleCategory,window[_0x39cddd(386)]=loadFromUrl,window.scrollToForm=scrollToForm,window[_0x39cddd(388)]=toggleEditSection,window.clearForm=clearForm,document[_0x39cddd(389)](_0x39cddd(370))[_0x39cddd(411)](_0x39cddd(395),async function(x){let $=_0x39cddd;x[$(442)]();let e=document[$(389)]($(371)).value.trim(),a=document[$(389)]($(362))[$(414)][$(465)](),t=document[$(389)]($(366))[$(414)].trim();if(!e){alert($(404));return}if(!a){alert($(349));return}if(!t){alert("⚠️ Por favor, completa tu tel\xe9fono");return}let o=[];if(allCategories[$(398)](x=>{let e=$,a=document.getElementById(e(466)+x[e(374)]),t=document[e(389)](e(454)+x.code);if(a&&a[e(340)]){let r=parseInt(t[e(414)]);if(!t[e(414)]||""===t[e(414)][e(465)]())throw alert(e(448)+x[e(443)]+'"'),t[e(450)](),Error(e(368));if(isNaN(r)||r<0||r>100)throw alert(e(428)+x[e(443)]+e(463)),t[e(450)](),Error(e(343));o[e(401)]({code:x[e(374)],percentage:r})}}),0===o.length){alert($(356));return}let r=encodeCategoriesBinary(o),_=$(403),d=encodeURIComponent(e);generatedUrl=_+$(344)+d+"&c="+r;let c={catalogName:e,clientName:a,clientPhone:t,url:generatedUrl,createdAt:new Date()[$(355)]()};await saveToFirebase(c),document[$(389)]($(375)).textContent=generatedUrl,document.getElementById($(413))[$(397)][$(354)]=$(457),document[$(389)]($(413))[$(423)]({behavior:$(459),block:"center"})}),window.copyUrl=copyUrl,window[_0x39cddd(382)]=visitCatalog,document[_0x39cddd(389)]("catalogName")[_0x39cddd(411)](_0x39cddd(475),function(x){let $=_0x39cddd,e=x[$(393)].value;e[$(467)]>50&&(x[$(393)][$(414)]=e[$(455)](0,50))}),document[_0x39cddd(389)]("existingUrl")[_0x39cddd(411)]("keypress",function(x){let $=_0x39cddd;x[$(392)]===$(460)&&(x[$(442)](),loadFromUrl())}),document[_0x39cddd(411)]("input",function(x){let $=_0x39cddd;if(x[$(393)].classList[$(400)]("category-percentage")){let e=parseInt(x[$(393)][$(414)]);x[$(393)].value[$(467)]>3&&(x[$(393)][$(414)]=x[$(393)][$(414)][$(455)](0,3),e=parseInt(x.target[$(414)])),e<0?x[$(393)].value=0:e>100&&(x[$(393)][$(414)]=100)}});
