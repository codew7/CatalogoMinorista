let _0x2dfd53=_0x4f33;!function($,x){let e=_0x4f33,a=$();for(;;)try{let t=-parseInt(e(506))/1*(-parseInt(e(485))/2)+parseInt(e(496))/3*(parseInt(e(408))/4)+-parseInt(e(542))/5*(-parseInt(e(440))/6)+parseInt(e(534))/7+parseInt(e(521))/8+parseInt(e(444))/9*(parseInt(e(511))/10)+-parseInt(e(436))/11*(parseInt(e(543))/12);if(179350===t)break;a.push(a.shift())}catch(o){a.push(a.shift())}}(_0x359c,179350);import{initializeApp as $}from"https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";import{getDatabase as x,ref as e,push as a,set as t}from"https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";let firebaseConfig={apiKey:_0x2dfd53(486),authDomain:_0x2dfd53(466),databaseURL:_0x2dfd53(416),projectId:_0x2dfd53(530),storageBucket:_0x2dfd53(520),messagingSenderId:"782674065763",appId:"1:782674065763:web:7f1112d846bbf98ca9bb56"},app=$(firebaseConfig),database=x(app),G_S_CONFIG={API_KEY:_0x2dfd53(441),SPREADSHEET_ID:"10QcnEi_INRU6Fn0UbdluXQC5KrU3JptMx5Y2ODF8OPg",RANGO:_0x2dfd53(469)};function _0x4f33($,x){let e=_0x359c();return(_0x4f33=function($,x){return e[$-=403]})($,x)}function setupPhoneValidation(){let $=_0x2dfd53,x=document[$(425)]($(489));x&&(x[$(514)]("input",function(x){let e=$;this[e(523)]=this[e(523)][e(450)](/[^0-9]/g,"")}),x.addEventListener($(472),function(x){let e=$,a=String.fromCharCode(x[e(414)]);/[0-9]/[e(461)](a)||x[e(463)]()}))}window[_0x2dfd53(514)](_0x2dfd53(409),function(){let $=_0x2dfd53;document[$(425)]("notification")[$(483)][$(513)]($(424)),loadCategories(),setupPhoneValidation()});let generatedUrl="",allCategories=[];function showNotification(){let $=_0x2dfd53,x=document[$(425)]($(535));x.classList[$(491)]($(424)),setTimeout(()=>{let e=$;x[e(483)][e(513)](e(424))},3e3)}function encodeCategoriesBinary($){let x=_0x2dfd53,e="";return $[x(422)]($=>{let a=x,t=$[a(420)];e+=String[a(503)](t[a(495)]);for(let o=0;o<t.length;o++)e+=t[o];e+=String[a(503)]($[a(458)])}),btoa(e)}function decodeCategoriesBinary($){let x=_0x2dfd53,e=new Map;try{let a=atob($),t=0;for(;t<a.length;){let o=a[x(493)](t);t++;let r="";for(let n=0;n<o;n++)r+=a[t],t++;let c=a[x(493)](t);t++,e[x(498)](r,c)}}catch(_){console.error("Error al decodificar formato binario:",_)}return e}function loadCategories(){let $=_0x2dfd53,x=document.getElementById($(519));x.innerHTML=$(443),fetch($(433)+G_S_CONFIG[$(445)]+$(465)+G_S_CONFIG[$(459)]+$(541)+G_S_CONFIG.API_KEY).then(x=>{let e=$;if(!x.ok)throw Error(e(428)+x[e(537)]);return x[e(487)]()})[$(446)](x=>{let e=$,a=x[e(533)];if(!a||0===a.length)throw Error(e(442));let t=new Map;a.forEach($=>{let x=e,a=$[0],o=$[7];a&&o&&""!==a[x(538)]()&&""!==o[x(538)]()&&!t.has(o)&&t[x(498)](o,a)}),allCategories=Array.from(t,([$,x])=>({code:$,name:x}))[e(527)](($,x)=>$[e(474)][e(431)](x[e(474)],"es",{sensitivity:"base"})),renderCategories()})[$(532)](e=>{let a=$;console[a(507)](a(512),e),x[a(518)]=a(508)+e[a(504)]+a(481)})}function renderCategories(){let $=_0x2dfd53,x=document[$(425)]($(519));if(0===allCategories[$(495)]){x[$(518)]='\n            <div class="no-categories">\n                <i class="fas fa-inbox" style="font-size: 2rem; color: #999; margin-bottom: 1rem;"></i>\n                <p>No se encontraron categor\xedas disponibles</p>\n            </div>\n        ';return}x[$(518)]=$(476)+allCategories[$(499)](x=>$(415)+x[$(420)]+'">\n                    <div class="category-header">\n                        <div class="category-name">\n                            <span>'+x.name+$(435)+x.code+$(524)+x.code+$(497)+x[$(420)]+$(418)+x[$(420)]+$(470))[$(526)]("")+"\n        </div>\n    ",setupCategoryListeners()}function setupCategoryListeners(){let $=_0x2dfd53;allCategories[$(422)](x=>{let e=$,a=document[e(425)]("check-"+x[e(420)]);a&&a[e(514)](e(522),function(){toggleCategory(x[e(420)])})})}function _0x359c(){let $=["toISOString","Porcentaje inv\xe1lido","innerHTML","categoriesContainer","registrocatalogopersonalizado.firebasestorage.app","2769000xfNBKA","change","value",'"\n                            data-code="',"writeText","join","sort","⚠️ La URL no contiene configuraci\xf3n de categor\xedas v\xe1lida","submit","registrocatalogopersonalizado","cat-","catch","values","1707237JiWhTQ","notification","⚠️ No se pudieron cargar las categor\xedas de la URL. Verifica que los c\xf3digos sean correctos.","statusText","trim","toggleIcon","toggleCategory","?key=","3265uxzAew","156iUhvnC","contains","_blank","toggleEditSection","⚠️ Hubo un error al guardar la informaci\xf3n. El cat\xe1logo se generar\xe1 de todas formas.","visitCatalog","1056392XSyfIy","DOMContentLoaded",'⚠️ Por favor, ingresa un porcentaje para la categor\xeda "',"⏳ Esperando a que se carguen las categor\xedas. Por favor, intenta de nuevo en unos segundos.","block",'⚠️ El porcentaje de "',"which",'\n                <div class="category-item" id="cat-',"https://registrocatalogopersonalizado-default-rtdb.firebaseio.com","target",'" style="margin-right: auto; cursor: pointer; user-select: none;">\n                            Incluir en cat\xe1logo\n                        </label>\n                        <input \n                            type="number" \n                            class="category-percentage" \n                            id="percent-',"catalogName","code","✅ Configuraci\xf3n cargada exitosamente!\n\nNombre: ","forEach","&c=","show","getElementById","https://catalogo.dev.ar/","Porcentaje faltante","Error al acceder a la API: ","textContent","loadFromUrl","localeCompare","resultContainer","https://sheets.googleapis.com/v4/spreadsheets/",".form-container:first-of-type",'</span>\n                        </div>\n                    </div>\n                    <div class="category-input-group">\n                        <input \n                            type="checkbox" \n                            class="category-checkbox" \n                            id="check-',"610511qauGhW","\nCategor\xedas: ","rotate","⚠️ La URL ingresada no es v\xe1lida. Por favor, verifica e intenta nuevamente.","300ErEAXP","AIzaSyDwiZWDc66tv4usDIA-IreiJMLFuk0236Q","No se encontraron datos en la hoja.",'\n        <div class="loading-categories">\n            <div class="loading-spinner"></div>\n            <p>Cargando categor\xedas...</p>\n        </div>\n    ',"1845NpJqSi","SPREADSHEET_ID","then","customizationForm","log","appendChild","replace","⚠️ Por favor, ingresa una URL v\xe1lida","urlDisplay","style","display","active","none","existingUrl","percentage","RANGO","execCommand","test","scrollIntoView","preventDefault","input","/values/","registrocatalogopersonalizado.firebaseapp.com","copyUrl","disabled","Lista!A2:Z",'"\n                            placeholder="% ganancia"\n                            min="0"\n                            max="100"\n                            step="1"\n                            maxlength="3"\n                            disabled\n                        >\n                        <span style="color: #666;">%</span>\n                    </div>\n                </div>\n            ',"smooth","keypress","open","name","⚠️ Por favor, completa tu tel\xe9fono",'\n        <div class="categories-grid">\n            ',"select","⚠️ Por favor, selecciona al menos una categor\xeda","focus","substring","</p>\n                </div>\n            ","⚠️ La URL no contiene un nombre de cat\xe1logo v\xe1lido","classList","scrollToForm","2FYVWTZ","AIzaSyCMP0Hue9bLs_dnybBM7h7AfjFaTTmNHKA","json","querySelector","clientPhone","percent-","add","createElement","charCodeAt","start","length","3fDpNFJ",'"\n                        >\n                        <label for="check-',"set","map","size","push","Error al parsear la URL:","fromCharCode","message","copy","13894XSAWZR","error",'\n                <div class="no-categories">\n                    <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #ff9800; margin-bottom: 1rem;"></i>\n                    <p>Error al cargar las categor\xedas</p>\n                    <p style="font-size: 0.9rem; margin-top: 0.5rem;">',"check-","checked","10TbWaFS","Error al cargar las categor\xedas:","remove","addEventListener","get"];return(_0x359c=function(){return $})()}function toggleCategory($){let x=_0x2dfd53,e=document[x(425)](x(509)+$),a=document[x(425)](x(490)+$),t=document[x(425)](x(531)+$);e&&e[x(510)]?(a[x(468)]=!1,a[x(479)](),t[x(483)][x(491)](x(455))):(a[x(468)]=!0,a[x(523)]="",t.classList[x(513)](x(455)))}function loadFromUrl(){let $=_0x2dfd53,x=document[$(425)]($(457))[$(523)][$(538)]();if(!x){alert($(451));return}try{let e=new URL(x),a=new URLSearchParams(e.search),t=a[$(515)]("n");if(!t){alert($(482));return}document[$(425)]($(419))[$(523)]=decodeURIComponent(t);let o=a[$(515)]("c");if(!o){alert($(528));return}let r=decodeCategoriesBinary(o);if(0===r[$(500)]){alert("⚠️ Error al decodificar la configuraci\xf3n. URL inv\xe1lida o corrupta.");return}if(0===allCategories.length){alert($(411));return}allCategories[$(422)](x=>{let e=$,a=document.getElementById(e(509)+x[e(420)]),t=document[e(425)](e(490)+x[e(420)]),o=document[e(425)](e(531)+x[e(420)]);a&&(a[e(510)]=!1,t[e(468)]=!0,t[e(523)]="",o.classList[e(513)](e(455)))});let n=0;r.forEach((x,e)=>{let a=$,t=document[a(425)](a(509)+e),o=document[a(425)](a(490)+e),r=document[a(425)](a(531)+e);t&&(t[a(510)]=!0,o[a(468)]=!1,o[a(523)]=x,r.classList[a(491)]("active"),n++)}),n>0?(alert($(421)+decodeURIComponent(t)+$(437)+n),document.getElementById($(457)).value="",scrollToForm()):alert($(536))}catch(c){console[$(507)]($(502),c),alert($(439))}}function scrollToForm(){let $=_0x2dfd53,x=document[$(488)]($(434));x&&x[$(462)]({behavior:$(471),block:$(494)})}function toggleEditSection(){let $=_0x2dfd53,x=document.getElementById("editContent"),e=document[$(425)]($(539));"none"===x[$(453)][$(454)]||""===x[$(453)][$(454)]?(x[$(453)][$(454)]=$(412),e[$(483)][$(491)]($(438))):(x[$(453)][$(454)]=$(456),e.classList[$(513)]($(438)))}function clearForm(){let $=_0x2dfd53;document[$(425)]($(419))[$(523)]="",allCategories[$(422)](x=>{let e=$,a=document[e(425)](e(509)+x[e(420)]),t=document[e(425)](e(490)+x[e(420)]),o=document[e(425)](e(531)+x[e(420)]);a&&(a[e(510)]=!1,t[e(468)]=!0,t[e(523)]="",o.classList[e(513)](e(455)))}),document[$(425)]($(432)).style.display="none",document[$(425)]("catalogName")[$(479)]()}async function saveToFirebase($){let x=_0x2dfd53;try{let o=e(database,"catalogos"),r=a(o);return await t(r,$),console[x(448)]("✅ Datos guardados en Firebase correctamente"),!0}catch(n){return console.error("❌ Error al guardar en Firebase:",n),alert(x(406)),!1}}function copyUrl(){let $=_0x2dfd53;generatedUrl&&navigator.clipboard[$(525)](generatedUrl).then(function(){showNotification()}).catch(function(x){let e=$,a=document[e(492)]("textarea");a[e(523)]=generatedUrl,document.body[e(449)](a),a[e(477)](),document[e(460)](e(505)),document.body.removeChild(a),showNotification()})}function visitCatalog(){let $=_0x2dfd53;generatedUrl&&window[$(473)](generatedUrl,$(404))}window[_0x2dfd53(540)]=toggleCategory,window[_0x2dfd53(430)]=loadFromUrl,window[_0x2dfd53(484)]=scrollToForm,window[_0x2dfd53(405)]=toggleEditSection,window.clearForm=clearForm,document.getElementById(_0x2dfd53(447))[_0x2dfd53(514)](_0x2dfd53(529),async function($){let x=_0x2dfd53;$[x(463)]();let e=document.getElementById(x(419))[x(523)][x(538)](),a=document[x(425)]("clientName")[x(523)][x(538)](),t=document[x(425)]("clientPhone").value[x(538)]();if(!e){alert("⚠️ Por favor, completa el nombre del cat\xe1logo");return}if(!a){alert("⚠️ Por favor, completa tu nombre completo");return}if(!t){alert(x(475));return}let o=[];if(allCategories[x(422)]($=>{let e=x,a=document[e(425)]("check-"+$[e(420)]),t=document.getElementById(e(490)+$[e(420)]);if(a&&a[e(510)]){let r=parseInt(t[e(523)]);if(!t[e(523)]||""===t[e(523)][e(538)]())throw alert(e(410)+$.name+'"'),t[e(479)](),Error(e(427));if(isNaN(r)||r<0||r>100)throw alert(e(413)+$[e(474)]+'" debe estar entre 0 y 100'),t.focus(),Error(e(517));o[e(501)]({code:$[e(420)],percentage:r})}}),0===o[x(495)]){alert(x(478));return}let r=encodeCategoriesBinary(o),n=x(426),c=encodeURIComponent(e);generatedUrl=n+"?n="+c+x(423)+r;let _={catalogName:e,clientName:a,clientPhone:t,url:generatedUrl,createdAt:new Date()[x(516)]()};await saveToFirebase(_),document[x(425)](x(452))[x(429)]=generatedUrl,document[x(425)](x(432))[x(453)][x(454)]="block",document[x(425)](x(432))[x(462)]({behavior:x(471),block:"center"})}),window[_0x2dfd53(467)]=copyUrl,window[_0x2dfd53(407)]=visitCatalog,document[_0x2dfd53(425)]("catalogName")[_0x2dfd53(514)](_0x2dfd53(464),function($){let x=_0x2dfd53,e=$[x(417)].value;e[x(495)]>50&&($.target[x(523)]=e[x(480)](0,50))}),document.getElementById(_0x2dfd53(457))[_0x2dfd53(514)](_0x2dfd53(472),function($){"Enter"===$.key&&($[_0x2dfd53(463)](),loadFromUrl())}),document.addEventListener(_0x2dfd53(464),function($){let x=_0x2dfd53;if($[x(417)][x(483)][x(403)]("category-percentage")){let e=parseInt($.target[x(523)]);$[x(417)][x(523)][x(495)]>3&&($[x(417)][x(523)]=$[x(417)][x(523)][x(480)](0,3),e=parseInt($[x(417)].value)),e<0?$[x(417)].value=0:e>100&&($[x(417)].value=100)}});
