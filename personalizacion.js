let _0x72c09=_0x13b8;!function($,x){let e=_0x13b8,a=$();for(;;)try{let t=parseInt(e(492))/1*(-parseInt(e(500))/2)+parseInt(e(568))/3*(parseInt(e(511))/4)+-parseInt(e(596))/5+parseInt(e(502))/6*(-parseInt(e(547))/7)+-parseInt(e(612))/8+-parseInt(e(600))/9+parseInt(e(503))/10*(parseInt(e(605))/11);if(591525===t)break;a.push(a.shift())}catch(o){a.push(a.shift())}}(_0x57fc,591525);import{initializeApp as $}from"https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";import{getDatabase as x,ref as e,push as a,set as t}from"https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";let firebaseConfig={apiKey:_0x72c09(534),authDomain:_0x72c09(517),databaseURL:_0x72c09(471),projectId:_0x72c09(563),storageBucket:_0x72c09(611),messagingSenderId:_0x72c09(558),appId:_0x72c09(473)},app=$(firebaseConfig),database=x(app),G_S_CONFIG={API_KEY:_0x72c09(520),SPREADSHEET_ID:"10QcnEi_INRU6Fn0UbdluXQC5KrU3JptMx5Y2ODF8OPg",RANGO:_0x72c09(533)};function setupPhoneValidation(){let $=_0x72c09,x=document[$(490)]("clientPhone");x&&(x.addEventListener("input",function(x){let e=$;this.value=this[e(494)][e(581)](/[^0-9]/g,"")}),x[$(495)]($(572),function(x){let e=$,a=String[e(569)](x[e(483)]);/[0-9]/[e(575)](a)||x.preventDefault()}))}window.addEventListener(_0x72c09(608),function(){let $=_0x72c09;document[$(490)]($(543))[$(607)][$(539)]($(521)),loadCategories(),setupPhoneValidation()});let generatedUrl="",allCategories=[];function _0x13b8($,x){let e=_0x57fc();return(_0x13b8=function($,x){return e[$-=470]})($,x)}function showNotification(){let $=_0x72c09,x=document.getElementById($(543));x[$(607)][$(504)]($(521)),setTimeout(()=>{x.classList.remove($(521))},3e3)}function encodeCategoriesBinary($){let x="";return $.forEach($=>{let e=_0x13b8,a=$[e(560)];x+=String[e(569)](a[e(513)]);for(let t=0;t<a[e(513)];t++)x+=a[t];x+=String.fromCharCode($.percentage)}),btoa(x)}function decodeCategoriesBinary($){let x=_0x72c09,e=new Map;try{let a=atob($),t=0;for(;t<a[x(513)];){let o=a[x(564)](t);t++;let r="";for(let n=0;n<o;n++)r+=a[t],t++;let c=a[x(564)](t);t++,e[x(610)](r,c)}}catch(i){console[x(553)](x(493),i)}return e}function loadCategories(){let $=_0x72c09,x=document.getElementById("categoriesContainer");x[$(509)]=$(588),fetch($(580)+G_S_CONFIG.SPREADSHEET_ID+$(505)+G_S_CONFIG.RANGO+$(582)+G_S_CONFIG.API_KEY)[$(524)](x=>{let e=$;if(!x.ok)throw Error(e(532)+x[e(497)]);return x[e(507)]()})[$(524)](x=>{let e=$,a=x[e(555)];if(!a||0===a[e(513)])throw Error("No se encontraron datos en la hoja.");let t=new Map;a[e(551)]($=>{let x=e,a=$[0],o=$[7];a&&o&&""!==a[x(477)]()&&""!==o[x(477)]()&&!t[x(526)](o)&&t[x(610)](o,a)}),allCategories=Array[e(522)](t,([$,x])=>({code:$,name:x}))[e(578)](($,x)=>$[e(514)][e(536)](x[e(514)],"es",{sensitivity:"base"})),renderCategories()}).catch(e=>{let a=$;console[a(553)](a(476),e),x[a(509)]=a(593)+e[a(557)]+"</p>\n                </div>\n            "})}function renderCategories(){let $=_0x72c09,x=document.getElementById($(554));if(0===allCategories.length){x[$(509)]=$(512);return}x[$(509)]=$(519)+allCategories[$(603)](x=>$(481)+x[$(560)]+$(525)+x[$(514)]+$(540)+x[$(560)]+'"\n                            data-code="'+x[$(560)]+$(599)+x[$(560)]+$(474)+x[$(560)]+$(538))[$(586)]("")+$(590),setupCategoryListeners()}function setupCategoryListeners(){let $=_0x72c09;allCategories[$(551)](x=>{let e=$,a=document[e(490)](e(475)+x[e(560)]);a&&a.addEventListener(e(515),function(){toggleCategory(x[e(560)])})})}function toggleCategory($){let x=_0x72c09,e=document[x(490)]("check-"+$),a=document.getElementById(x(589)+$),t=document.getElementById(x(570)+$);e&&e[x(579)]?(a[x(485)]=!1,a[x(606)](),t.classList[x(504)]("active")):(a[x(485)]=!0,a[x(494)]="",t.classList[x(539)](x(602)))}function loadFromUrl(){let $=_0x72c09,x=document[$(490)]($(559))[$(494)][$(477)]();if(!x){alert("⚠️ Por favor, ingresa una URL v\xe1lida");return}try{let e=new URL(x),a=new URLSearchParams(e[$(484)]),t=a.get("n");if(!t){alert($(583));return}document[$(490)]($(601))[$(494)]=decodeURIComponent(t);let o=a.get("c");if(!o){alert("⚠️ La URL no contiene configuraci\xf3n de categor\xedas v\xe1lida");return}let r=decodeCategoriesBinary(o);if(0===r[$(498)]){alert($(576));return}if(0===allCategories[$(513)]){alert($(527));return}allCategories[$(551)](x=>{let e=$,a=document[e(490)]("check-"+x.code),t=document[e(490)]("percent-"+x[e(560)]),o=document[e(490)](e(570)+x.code);a&&(a[e(579)]=!1,t.disabled=!0,t[e(494)]="",o[e(607)][e(539)](e(602)))});let n=0;r[$(551)]((x,e)=>{let a=$,t=document[a(490)](a(475)+e),o=document[a(490)](a(589)+e),r=document[a(490)]("cat-"+e);t&&(t[a(579)]=!0,o[a(485)]=!1,o.value=x,r[a(607)][a(504)](a(602)),n++)}),n>0?(alert($(506)+decodeURIComponent(t)+$(567)+n),document[$(490)]($(559))[$(494)]="",scrollToForm()):alert($(595))}catch(c){console[$(553)]("Error al parsear la URL:",c),alert($(480))}}function scrollToForm(){let $=_0x72c09,x=document.querySelector(".form-container:first-of-type");x&&x[$(523)]({behavior:$(482),block:$(510)})}function toggleEditSection(){let $=_0x72c09,x=document[$(490)]($(472)),e=document[$(490)]($(488));"none"===x[$(486)].display||""===x[$(486)].display?(x[$(486)][$(548)]="block",e[$(607)][$(504)]("rotate")):(x[$(486)][$(548)]="none",e[$(607)][$(539)]($(479)))}function clearForm(){let $=_0x72c09;document.getElementById($(601))[$(494)]="",allCategories[$(551)](x=>{let e=$,a=document.getElementById("check-"+x[e(560)]),t=document.getElementById(e(589)+x[e(560)]),o=document[e(490)]("cat-"+x[e(560)]);a&&(a[e(579)]=!1,t[e(485)]=!0,t.value="",o[e(607)][e(539)](e(602)))}),document.getElementById($(478))[$(486)].display=$(604),document[$(490)]($(601))[$(606)]()}function _0x57fc(){let $=["length","name","change","preventDefault","registrocatalogopersonalizado.firebaseapp.com","submit",'\n        <div class="categories-grid">\n            ',"AIzaSyDwiZWDc66tv4usDIA-IreiJMLFuk0236Q","show","from","scrollIntoView","then",'">\n                    <div class="category-header">\n                        <div class="category-name">\n                            <span>',"has","⏳ Esperando a que se carguen las categor\xedas. Por favor, intenta de nuevo en unos segundos.","⚠️ Por favor, completa el nombre del cat\xe1logo","appendChild","target","clipboard","Error al acceder a la API: ","Lista!A2:Z","AIzaSyCMP0Hue9bLs_dnybBM7h7AfjFaTTmNHKA","visitCatalog","localeCompare","createElement",'"\n                            placeholder="% ganancia"\n                            min="0"\n                            max="100"\n                            step="1"\n                            maxlength="3"\n                            disabled\n                        >\n                        <span style="color: #666;">%</span>\n                    </div>\n                </div>\n            ',"remove",'</span>\n                        </div>\n                    </div>\n                    <div class="category-input-group">\n                        <input \n                            type="checkbox" \n                            class="category-checkbox" \n                            id="check-',"category-percentage","toISOString","notification","❌ Error al guardar en Firebase:",'⚠️ Por favor, ingresa un porcentaje para la categor\xeda "',"✅ Datos guardados en Firebase correctamente","146650jCGngp","display","input","block","forEach","open","error","categoriesContainer","values",'⚠️ El porcentaje de "',"message","782674065763","existingUrl","code","substring",'" debe estar entre 0 y 100',"registrocatalogopersonalizado","charCodeAt","textarea","contains","\nCategor\xedas: ","11268pkuXRl","fromCharCode","cat-","key","keypress","clientPhone","?n=","test","⚠️ Error al decodificar la configuraci\xf3n. URL inv\xe1lida o corrupta.","clientName","sort","checked","https://sheets.googleapis.com/v4/spreadsheets/","replace","?key=","⚠️ La URL no contiene un nombre de cat\xe1logo v\xe1lido","log","https://catalogo.dev.ar/","join","select",'\n        <div class="loading-categories">\n            <div class="loading-spinner"></div>\n            <p>Cargando categor\xedas...</p>\n        </div>\n    ',"percent-","\n        </div>\n    ","center","body",'\n                <div class="no-categories">\n                    <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #ff9800; margin-bottom: 1rem;"></i>\n                    <p>Error al cargar las categor\xedas</p>\n                    <p style="font-size: 0.9rem; margin-top: 0.5rem;">',"customizationForm","⚠️ No se pudieron cargar las categor\xedas de la URL. Verifica que los c\xf3digos sean correctos.","241240LKuWVw","catch","&c=",'"\n                        >\n                        <label for="check-',"10313901OJBveG","catalogName","active","map","none","959783kaBbTy","focus","classList","DOMContentLoaded","clearForm","set","registrocatalogopersonalizado.firebasestorage.app","8143064ERmaXE","⚠️ Por favor, completa tu nombre completo","https://registrocatalogopersonalizado-default-rtdb.firebaseio.com","editContent","1:782674065763:web:7f1112d846bbf98ca9bb56",'" style="margin-right: auto; cursor: pointer; user-select: none;">\n                            Incluir en cat\xe1logo\n                        </label>\n                        <input \n                            type="number" \n                            class="category-percentage" \n                            id="percent-',"check-","Error al cargar las categor\xedas:","trim","resultContainer","rotate","⚠️ La URL ingresada no es v\xe1lida. Por favor, verifica e intenta nuevamente.",'\n                <div class="category-item" id="cat-',"smooth","which","search","disabled","style","Porcentaje inv\xe1lido","toggleIcon","copy","getElementById","_blank","7177sSGdiZ","Error al decodificar formato binario:","value","addEventListener","execCommand","statusText","size","textContent","94KZOoOu","Porcentaje faltante","6GuqZor","340JbNkrj","add","/values/","✅ Configuraci\xf3n cargada exitosamente!\n\nNombre: ","json","copyUrl","innerHTML","start","208zaxidV",'\n            <div class="no-categories">\n                <i class="fas fa-inbox" style="font-size: 2rem; color: #999; margin-bottom: 1rem;"></i>\n                <p>No se encontraron categor\xedas disponibles</p>\n            </div>\n        '];return(_0x57fc=function(){return $})()}async function saveToFirebase($){let x=_0x72c09;try{let o=e(database,"catalogos"),r=a(o);return await t(r,$),console[x(584)](x(546)),!0}catch(n){return console.error(x(544),n),alert("⚠️ Hubo un error al guardar la informaci\xf3n. El cat\xe1logo se generar\xe1 de todas formas."),!1}}function copyUrl(){let $=_0x72c09;generatedUrl&&navigator[$(531)].writeText(generatedUrl).then(function(){showNotification()})[$(597)](function(x){let e=$,a=document[e(537)](e(565));a[e(494)]=generatedUrl,document.body[e(529)](a),a[e(587)](),document[e(496)](e(489)),document[e(592)].removeChild(a),showNotification()})}function visitCatalog(){let $=_0x72c09;generatedUrl&&window[$(552)](generatedUrl,$(491))}window.toggleCategory=toggleCategory,window.loadFromUrl=loadFromUrl,window.scrollToForm=scrollToForm,window.toggleEditSection=toggleEditSection,window[_0x72c09(609)]=clearForm,document[_0x72c09(490)](_0x72c09(594))[_0x72c09(495)](_0x72c09(518),async function($){let x=_0x72c09;$[x(516)]();let e=document[x(490)](x(601))[x(494)][x(477)](),a=document.getElementById(x(577))[x(494)][x(477)](),t=document[x(490)](x(573))[x(494)][x(477)]();if(!e){alert(x(528));return}if(!a){alert(x(470));return}if(!t){alert("⚠️ Por favor, completa tu tel\xe9fono");return}let o=[];allCategories[x(551)]($=>{let e=x,a=document[e(490)](e(475)+$.code),t=document.getElementById(e(589)+$.code);if(a&&a[e(579)]){let r=parseInt(t.value);if(!t[e(494)]||""===t.value[e(477)]())throw alert(e(545)+$[e(514)]+'"'),t.focus(),Error(e(501));if(isNaN(r)||r<0||r>100)throw alert(e(556)+$.name+e(562)),t[e(606)](),Error(e(487));o.push({code:$[e(560)],percentage:r})}});let r="";o[x(513)]>0&&(r=encodeCategoriesBinary(o));let n=x(585),c=encodeURIComponent(e);generatedUrl=r?n+"?n="+c+x(598)+r:n+x(574)+c;let i={catalogName:e,clientName:a,clientPhone:t,url:generatedUrl,createdAt:new Date()[x(542)]()};await saveToFirebase(i),document[x(490)]("urlDisplay")[x(499)]=generatedUrl,document[x(490)]("resultContainer")[x(486)][x(548)]=x(550),document[x(490)](x(478))[x(523)]({behavior:x(482),block:x(591)})}),window[_0x72c09(508)]=copyUrl,window[_0x72c09(535)]=visitCatalog,document[_0x72c09(490)](_0x72c09(601))[_0x72c09(495)](_0x72c09(549),function($){let x=_0x72c09,e=$[x(530)][x(494)];e[x(513)]>50&&($[x(530)][x(494)]=e[x(561)](0,50))}),document[_0x72c09(490)](_0x72c09(559))[_0x72c09(495)]("keypress",function($){let x=_0x72c09;"Enter"===$[x(571)]&&($[x(516)](),loadFromUrl())}),document.addEventListener(_0x72c09(549),function($){let x=_0x72c09;if($[x(530)][x(607)][x(566)](x(541))){let e=parseInt($.target[x(494)]);$[x(530)][x(494)][x(513)]>3&&($[x(530)].value=$[x(530)][x(494)][x(561)](0,3),e=parseInt($[x(530)][x(494)])),e<0?$.target[x(494)]=0:e>100&&($[x(530)].value=100)}});
